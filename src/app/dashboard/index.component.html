<app-page-header [sharableURL]="sharableURL">
    <mat-icon matListItemIcon aria-hidden="true" [fontIcon]="getIcon('dashboard')"></mat-icon>
    <span i18n="Page title"> Dashboard </span>
  </app-page-header>
  
  <div class="fab">
    <!-- TODO: add an animtation, https://angular.io/guide/animations -->
    @if (showFabActions) {
      <div class="fab-actions">
        <button mat-mini-fab matTooltip="Split Lines" i18n-matTooltip (click)="onSplitLinesDialog()">
          <mat-icon [fontIcon]="getIcon('vertical-split')"></mat-icon>
        </button>
        @if (!hasOnlyOneLine()) {
          <button mat-mini-fab matTooltip="Reorganize Lines" i18n-matTooltip (click)="onReorganizeLinesDialog()">
            <mat-icon [fontIcon]="getIcon('list')"></mat-icon>
          </button>
        }

        <button mat-mini-fab matTooltip="Add a Line" i18n-matTooltip (click)="onAddLineDialog()">
          <mat-icon [fontIcon]="getIcon('add')"></mat-icon>
        </button>
      </div>
    }
    <button class="fab-activator" mat-fab color="primary" (click)="openFab()" matTooltip="Customize Dashboard">
      <mat-icon [fontIcon]="getIcon('settings')"></mat-icon>
    </button>
  </div>
  
  @if (lines.length === 0) {
    <div class="no-line">
      <em i18n>
        Your dashboard is empty, add a line to start monitoring your tasks.
      </em>
      <button mat-raised-button color="primary" (click)="onAddLineDialog()">Add a line</button>
    </div>
  }
  
  <main class="lines" [style]="'grid-template-columns: repeat(' + columns + ', 1fr);'">
    @for (line of lines; track line.name+line.type) {
      @switch (line.type) {
        @case ('CountStatus') {
          @if (hasCountStatusPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-task-status-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
        @case ('Applications') {
          @if (hasApplicationsPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-applications-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
        @case ('Results') {
          @if (hasResultsPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-results-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
        @case ('Partitions') {
          @if (hasPartitionsPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-partitions-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
        @case ('Sessions') {
          @if (hasSessionsPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-sessions-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
        @case ('Tasks') {
          @if (hasTasksPermission) {
            <section>
              <app-page-section-header [icon]="getLineIcon(line.type)">
                <span [id]="line.type + '-' + $index" i18n="Section title">{{ line.name }}</span>
              </app-page-section-header>
              <app-dashboard-tasks-line [line]="line" (lineChange)="onSaveChange()" (lineDelete)="onDeleteLine($event)"/>
            </section>
          }
        }
      }
    }
  </main>