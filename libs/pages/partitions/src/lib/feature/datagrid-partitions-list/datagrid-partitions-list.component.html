<clr-datagrid (clrDgRefresh)="onRefresh($event)" [clrDgLoading]="loading">
  <clr-dg-action-bar class="clr-row clr-justify-content-between clr-align-items-center">
    <div>
      <armonik-admin-gui-refresh-button (refresh)="onManualRefresh()"></armonik-admin-gui-refresh-button>
      <armonik-admin-gui-auto-refresh-button (refresh)="onAutoRefresh()" (intervalChange)="onIntervalChange($event)"
        [interval]="restoreCurrentInterval()">
      </armonik-admin-gui-auto-refresh-button>
    </div>
    <armonik-admin-gui-actions-dropdown (clearFilters)="onClearFilters()"
      (clearSort)="onClearSort()"></armonik-admin-gui-actions-dropdown>
  </clr-dg-action-bar>

  <clr-dg-column [clrDgField]="fields.id" [clrDgSortOrder]="(getQueryParamsOrderByColumn$(fields.id) | async)!">
    <span i18n> Id </span>
    <clr-dg-filter [clrDgFilter]="idFilter">
      <!-- TODO: update this filter to avoid sync issue when clearing -->
      <armonik-admin-gui-id-filter name="id" [selectedValue]="getQueryParamsFilterByColumn$('id') | async" #idFilter>
      </armonik-admin-gui-id-filter>
    </clr-dg-filter>
  </clr-dg-column>

  <!-- There a known bug that fire 2 requests when using browser history and navigating from id to priority. Could come from Clarity. -->
  <clr-dg-column [clrDgField]="fields.priority"
    [clrDgSortOrder]="(getQueryParamsOrderByColumn$(fields.priority) | async)!">
    <span i18n> Priority </span>
  </clr-dg-column>
  <clr-dg-column i18n> Actions </clr-dg-column>

  <ng-container *ngIf="list$ | async as list">
    <clr-dg-row *ngFor="let partition of list.partitions; trackBy: trackByPartition">
      <clr-dg-cell> {{ partition.id }} </clr-dg-cell>
      <clr-dg-cell> {{ partition.priority }} </clr-dg-cell>
      <clr-dg-cell>
        <a [routerLink]="['/', 'partitions', partition.id]" type="button" class="btn btn-sm btn-secondary">
          <cds-icon shape="eye"></cds-icon>
          <span i18n class="sr-only">
            View partition {{ partition.id }}
          </span>
        </a>
      </clr-dg-cell>
    </clr-dg-row>
  </ng-container>

  <clr-dg-footer>
    <clr-dg-pagination [clrDgPageSize]="(getQueryParamsPageSize$() | async)!" [clrDgTotalItems]="total"
      [clrDgPage]="(getQueryParamsPage$() | async)!">
      <clr-dg-page-size [clrPageSizeOptions]="[10, 20, 50, 100]">
        <span i18n>Partitions per page</span>
      </clr-dg-page-size>
      <span>
        {{ total }} { total, plural, =1 { partition } other { partitions } }
      </span>
    </clr-dg-pagination>
  </clr-dg-footer>
</clr-datagrid>
