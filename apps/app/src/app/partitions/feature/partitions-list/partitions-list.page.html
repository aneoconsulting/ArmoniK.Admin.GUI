<section>
  <h1>Partitions</h1>

  <clr-datagrid (clrDgRefresh)="refreshPartitions($event)">
    <clr-dg-action-bar>
      <app-action-bar
        [stopInterval$]="stopInterval$"
        [isFiltered]="isFiltered()"
        [isOrdered]="isOrdered()"
        (refresh)="manualRefreshPartitions()"
        (updateInterval)="onUpdateInterval($event)"
        (clearFilters)="clearAllFilters()"
        (clearSort)="clearOrder()"
      >
      </app-action-bar>
    </clr-dg-action-bar>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_ID.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_ID)"
    >
      Id
      <clr-dg-filter [clrDgFilter]="idFilter">
        <app-id-filter
          [name]="'id'"
          [inputValue]="filterPartitionId"
          #idFilter
        >
        </app-id-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_PARENT_PARTITION_IDS.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_PARENT_PARTITION_IDS)"
    >
      Parent
      <clr-dg-filter [clrDgFilter]="idParentFilter">
        <app-id-filter
          [name]="'parentId'"
          [inputValue]="filterParentId"
          #idParentFilter
        >
        </app-id-filter>
      </clr-dg-filter>
    </clr-dg-column>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_POD_RESERVED.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_POD_RESERVED)"
    >
      Reserved pods
    </clr-dg-column>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_POD_MAX.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_POD_MAX)"
    >
      Maximum pods
    </clr-dg-column>
    <clr-dg-column>
      Pods configuration
    </clr-dg-column>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_PREEMPTION_PERCENTAGE.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_PREEMPTION_PERCENTAGE)"
    >
      Percentage
    </clr-dg-column>
    <clr-dg-column
      [clrDgField]="OrderByField.ORDER_BY_FIELD_PRIORITY.toString()"
      [clrDgSortOrder]="defaultSortOrder(OrderByField.ORDER_BY_FIELD_PRIORITY)"
    >
      Priority
    </clr-dg-column>

    <ng-container *ngIf="loadPartitions$ | async as list">
      <clr-dg-row
        *ngFor="let partition of list.partitions; trackBy: trackByPartition"
      >
        <clr-dg-cell> {{ partition.id }} </clr-dg-cell>
        <clr-dg-cell>
          <a
            [routerLink]="['/', 'partitions']"
            [queryParams]="{ id: partition.parentPartitionIds }"
          >
            {{ partition.parentPartitionIds }}
          </a>
        </clr-dg-cell>
        <clr-dg-cell>
          <a
            [routerLink]="['/', 'partitions']"
            [queryParams]="{ podReserved: partition.podReserved }"
          >
            {{ partition.podReserved }}
          </a>
        </clr-dg-cell>
        <clr-dg-cell> {{ partition.podMax }} </clr-dg-cell>
        <clr-dg-cell> {{ partition.podConfiguration }} </clr-dg-cell>
        <clr-dg-cell> {{ partition.preemptionPercentage }} </clr-dg-cell>
        <clr-dg-cell> {{ partition.priority }} </clr-dg-cell>
      </clr-dg-row>
    </ng-container>
    <clr-dg-footer>
      <clr-dg-pagination>
        <clr-dg-page-size [clrPageSizeOptions]="[10, 20, 50, 100]">
          Partitions per page
        </clr-dg-page-size>
        <span *ngIf="(totalPartitions$ | async) ?? 0 > 1 as total">
          {{ total }} { total, plural, =1 {partition} other {partitions}}
        </span>
      </clr-dg-pagination>
    </clr-dg-footer>
  </clr-datagrid>
</section>
